---
title: "FPR project"
author: "Krista DeStasio & Brendan Cullen"
date: "4/15/2019"
output: html_document
---

```{r setup, include=FALSE}
library("factoextra")
library("tidyverse")
library("janitor")

knitr::opts_chunk$set(echo = TRUE)
```

```{r}
iris_clean <- clean_names(iris)

clust_out <- eclust(iris_clean[,1:4], 
                     FUNcluster = 'kmeans', 
                     hc_metric = 'euclidean',
                     k = 3, nstart = 25, graph = FALSE)

str(clust_out)

clust_data <- cbind(clust_out[1], iris_clean)

plot_data <- clust_data %>% mutate(cluster = as.factor(cluster)) %>% 
    gather(sepal_length, sepal_width, petal_length, petal_width, 
           value = value, key = variable_name) 

plot_data %>% 
    ggplot(aes(x = variable_name, y = value, color = cluster)) +
    geom_jitter()
    
plot_data %>% 
    ggplot(aes(x = variable_name, y = value, color = cluster)) +
    geom_jitter() + 
    facet_wrap(~species)

fviz_silhouette(clust_out, palette = "jco",
                         print.summary = FALSE) + 
             theme_minimal() + 
             ggtitle(paste0("Silhouette Plot of K-means With ", 3, " Clusters"))

sil <- clust_out$silinfo$widths[, 1:3]
neg_sil_index <- which(sil[, 'sil_width'] < 0)
```

